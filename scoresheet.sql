-- MySQL Script generated by MySQL Workbench
-- Mon Dec  3 00:17:30 2018
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema scoresheet
-- -----------------------------------------------------

-- -----------------------------------------------------
-- Schema scoresheet
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `scoresheet` DEFAULT CHARACTER SET utf8 ;
USE `scoresheet` ;

-- -----------------------------------------------------
-- Table `scoresheet`.`role`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `scoresheet`.`role` ;

CREATE TABLE IF NOT EXISTS `scoresheet`.`role` (
  `id` INT NOT NULL,
  `name` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `scoresheet`.`user`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `scoresheet`.`user` ;

CREATE TABLE IF NOT EXISTS `scoresheet`.`user` (
  `id` INT NOT NULL,
  `login` VARCHAR(45) NOT NULL,
  `password` VARCHAR(45) NOT NULL,
  `role` INT NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE INDEX `login_UNIQUE` (`login` ASC),
  INDEX `usr_role_idx` (`role` ASC),
  CONSTRAINT `usr_role`
    FOREIGN KEY (`role`)
    REFERENCES `scoresheet`.`role` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `scoresheet`.`student`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `scoresheet`.`student` ;

CREATE TABLE IF NOT EXISTS `scoresheet`.`student` (
  `id` INT NOT NULL,
  `name` VARCHAR(45) NOT NULL,
  `surname` VARCHAR(45) NOT NULL,
  `fathername` VARCHAR(45) NOT NULL,
  `group` INT NOT NULL,
  `course` INT NOT NULL,
  `user_id` INT NOT NULL,
  `info` TEXT(1000) NULL,
  PRIMARY KEY (`id`),
  INDEX `user_idx` (`user_id` ASC),
  CONSTRAINT `student_user`
    FOREIGN KEY (`user_id`)
    REFERENCES `scoresheet`.`user` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `scoresheet`.`teacher`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `scoresheet`.`teacher` ;

CREATE TABLE IF NOT EXISTS `scoresheet`.`teacher` (
  `id` INT NOT NULL,
  `name` VARCHAR(45) NOT NULL,
  `surname` VARCHAR(45) NOT NULL,
  `fathername` VARCHAR(45) NOT NULL,
  `user_id` INT NOT NULL,
  `info` TEXT(1000) NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `teacher_user_idx` (`user_id` ASC),
  CONSTRAINT `teacher_user`
    FOREIGN KEY (`user_id`)
    REFERENCES `scoresheet`.`user` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `scoresheet`.`administration`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `scoresheet`.`administration` ;

CREATE TABLE IF NOT EXISTS `scoresheet`.`administration` (
  `id` INT NOT NULL,
  `name` VARCHAR(45) NOT NULL,
  `surname` VARCHAR(45) NOT NULL,
  `fathername` VARCHAR(45) NOT NULL,
  `info` TEXT(1000) NOT NULL,
  `user_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `user_idx` (`user_id` ASC),
  CONSTRAINT `administration_user`
    FOREIGN KEY (`user_id`)
    REFERENCES `scoresheet`.`user` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `scoresheet`.`subject`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `scoresheet`.`subject` ;

CREATE TABLE IF NOT EXISTS `scoresheet`.`subject` (
  `id` INT NOT NULL,
  `name` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `scoresheet`.`mark_category`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `scoresheet`.`mark_category` ;

CREATE TABLE IF NOT EXISTS `scoresheet`.`mark_category` (
  `id` INT NOT NULL,
  `name` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `scoresheet`.`mark`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `scoresheet`.`mark` ;

CREATE TABLE IF NOT EXISTS `scoresheet`.`mark` (
  `id` INT NOT NULL,
  `student_id` INT NOT NULL,
  `teacher_id` INT NOT NULL,
  `mark` VARCHAR(2) NOT NULL,
  `subject` INT NOT NULL,
  `category` INT NOT NULL,
  `mark_date` DATE NULL,
  PRIMARY KEY (`id`),
  INDEX `mark_subject_idx` (`subject` ASC),
  INDEX `category_key_idx` (`category` ASC),
  INDEX `mark_teacher_idx` (`teacher_id` ASC),
  CONSTRAINT `mark_subject`
    FOREIGN KEY (`subject`)
    REFERENCES `scoresheet`.`subject` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `category_key`
    FOREIGN KEY (`category`)
    REFERENCES `scoresheet`.`mark_category` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `mark_student`
    FOREIGN KEY (`student_id`)
    REFERENCES `scoresheet`.`student` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `mark_teacher`
    FOREIGN KEY (`teacher_id`)
    REFERENCES `scoresheet`.`teacher` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `scoresheet`.`group_subject`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `scoresheet`.`group_subject` ;

CREATE TABLE IF NOT EXISTS `scoresheet`.`group_subject` (
  `id` INT NOT NULL,
  `subject_id` INT NOT NULL,
  `teacher_id` INT NOT NULL,
  `group` INT NOT NULL,
  `course` INT NOT NULL,
  PRIMARY KEY (`id`),
  INDEX `gr_subj_idx` (`subject_id` ASC),
  INDEX `gr_teacher_idx` (`teacher_id` ASC),
  CONSTRAINT `gr_subj`
    FOREIGN KEY (`subject_id`)
    REFERENCES `scoresheet`.`subject` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `gr_teacher`
    FOREIGN KEY (`teacher_id`)
    REFERENCES `scoresheet`.`teacher` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -----------------------------------------------------
-- Data for table `scoresheet`.`role`
-- -----------------------------------------------------
START TRANSACTION;
USE `scoresheet`;
INSERT INTO `scoresheet`.`role` (`id`, `name`) VALUES (1, 'Student');
INSERT INTO `scoresheet`.`role` (`id`, `name`) VALUES (2, 'Teacher');
INSERT INTO `scoresheet`.`role` (`id`, `name`) VALUES (3, 'Administration');
INSERT INTO `scoresheet`.`role` (`id`, `name`) VALUES (4, 'Decan');

COMMIT;


-- -----------------------------------------------------
-- Data for table `scoresheet`.`user`
-- -----------------------------------------------------
START TRANSACTION;
USE `scoresheet`;
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (1, 'fpm.kustov', 'be57412276920ea15b79f9fa55c9d8a5', 1);
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (2, 'fpm.gurinovich', 'c553297dfb10fa9d162477fd6a8a4d22', 1);
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (3, 'fpm.deryabin', '1f999e7b81a62e15a1b7fc9ac3bcabdf', 1);
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (4, 'fpm.emelyanova', '28c90e93bce4dc4b795360352f1d2802', 1);
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (5, 'fpm.zalesskiy', 'ffe2d4f38938bd30fd7e189f8a596275', 1);
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (6, 'fpm.zarembin', '1544ff5f09cfe61b0d7f974081f04473', 1);
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (7, 'fpm.kulak', 'cf16d6a067fc9acec66908f2c69431b0', 1);
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (8, 'fpm.litvinko', '2bb9a612d4ddc7c7a71564ff70368799', 1);
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (9, 'fpm.zhukovskiy', 'e301d4529c1ffd4cd2f75657caa96c60', 1);
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (10, 'fpm.manets', '74774daa7b9d11b80878b7bfa56c27d1', 1);
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (11, 'fpm.novikov', '10479c5f602151b12277511b2b4fc170', 1);
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (12, 'fpm.otyuckiy', 'c45df8585a1a31ea9693cdace4f72c2f', 1);
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (13, 'fpm.pechenev', '1159962f236aaef5d18435db33b90830', 1);
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (14, 'fpm.polischuk', '5cad3811105c321dec638b0772296193', 1);
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (15, 'fpm.romanovets', '13ce9fee2eb3106a209c0ed820bc8510', 1);
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (16, 'fpm.tkachev', '280c8f1598d9813bfe0ddcd88ea46fc7', 1);
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (17, 'fpm.tkachuk', '6a5c438c2169730918dadabccbb69263', 1);
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (18, 'fpm.travnichev', 'c0c919753d4025e7cc9379b694372142', 1);
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (19, 'fpm.shtabnoy', '11770ca0de5783cfd4b215497f6b7cd1', 1);
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (20, 'fpm.elyashevich', 'f6fad8c5c0ae469f4a0ac97e0727cc83', 1);
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (21, 'fpm.isachenko', '0bb285d344ed1585fcf61f1c6af87c17', 2);
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (22, 'fpm.obraztcov', 'ba10308b380aa91ed8bc2e63e28f9871', 2);
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (23, 'fpm.kirlitsa', 'cf14af5289a308e739ce3da26b11774b', 2);
INSERT INTO `scoresheet`.`user` (`id`, `login`, `password`, `role`) VALUES (24, 'fpm.vorotnitskaya', '48a77ea45e209e89e098ccec7d38fb59', 3);

COMMIT;


-- -----------------------------------------------------
-- Data for table `scoresheet`.`student`
-- -----------------------------------------------------
START TRANSACTION;
USE `scoresheet`;
INSERT INTO `scoresheet`.`student` (`id`, `name`, `surname`, `fathername`, `group`, `course`, `user_id`, `info`) VALUES (1, 'Максим', 'Гуринович', 'Андреевич', 1, 4, 2, NULL);
INSERT INTO `scoresheet`.`student` (`id`, `name`, `surname`, `fathername`, `group`, `course`, `user_id`, `info`) VALUES (2, 'Кирилл', 'Дерябин', 'Михайлович', 1, 4, 3, NULL);
INSERT INTO `scoresheet`.`student` (`id`, `name`, `surname`, `fathername`, `group`, `course`, `user_id`, `info`) VALUES (3, 'Ирина', 'Емельянова', 'Олеговна', 1, 4, 4, 'Занимается робототехникой');
INSERT INTO `scoresheet`.`student` (`id`, `name`, `surname`, `fathername`, `group`, `course`, `user_id`, `info`) VALUES (4, 'Максим', 'Жуковский', 'Сергеевич', 1, 4, 9, 'Певец');
INSERT INTO `scoresheet`.`student` (`id`, `name`, `surname`, `fathername`, `group`, `course`, `user_id`, `info`) VALUES (5, 'Никита', 'Залесский', 'Романович', 1, 4, 5, NULL);
INSERT INTO `scoresheet`.`student` (`id`, `name`, `surname`, `fathername`, `group`, `course`, `user_id`, `info`) VALUES (6, 'Евгений', 'Зарембин', 'Андреевич', 1, 4, 6, NULL);
INSERT INTO `scoresheet`.`student` (`id`, `name`, `surname`, `fathername`, `group`, `course`, `user_id`, `info`) VALUES (7, 'Константин', 'Кулак', 'Анатольевич', 1, 4, 7, NULL);
INSERT INTO `scoresheet`.`student` (`id`, `name`, `surname`, `fathername`, `group`, `course`, `user_id`, `info`) VALUES (8, 'Иван', 'Кустов', 'Андреевич', 1, 4, 1, NULL);
INSERT INTO `scoresheet`.`student` (`id`, `name`, `surname`, `fathername`, `group`, `course`, `user_id`, `info`) VALUES (9, 'Дмитрий', 'Литвинко', 'Сергеевич', 1, 4, 8, NULL);
INSERT INTO `scoresheet`.`student` (`id`, `name`, `surname`, `fathername`, `group`, `course`, `user_id`, `info`) VALUES (10, 'Мария', 'Манец', 'Алексеевна', 1, 4, 10, NULL);
INSERT INTO `scoresheet`.`student` (`id`, `name`, `surname`, `fathername`, `group`, `course`, `user_id`, `info`) VALUES (11, 'Алексей', 'Новиков', 'Юрьевич', 1, 4, 11, NULL);
INSERT INTO `scoresheet`.`student` (`id`, `name`, `surname`, `fathername`, `group`, `course`, `user_id`, `info`) VALUES (12, 'Алексей', 'Отюцкий', 'Станиславович', 1, 4, 12, NULL);
INSERT INTO `scoresheet`.`student` (`id`, `name`, `surname`, `fathername`, `group`, `course`, `user_id`, `info`) VALUES (13, 'Николай ', 'Печенев', 'Леонидович', 1, 4, 13, NULL);
INSERT INTO `scoresheet`.`student` (`id`, `name`, `surname`, `fathername`, `group`, `course`, `user_id`, `info`) VALUES (14, 'Александр', 'Полищук', 'Михайлович', 1, 4, 14, NULL);
INSERT INTO `scoresheet`.`student` (`id`, `name`, `surname`, `fathername`, `group`, `course`, `user_id`, `info`) VALUES (15, 'Дмитрий', 'Романовец', 'Сергеевич', 1, 4, 15, NULL);
INSERT INTO `scoresheet`.`student` (`id`, `name`, `surname`, `fathername`, `group`, `course`, `user_id`, `info`) VALUES (16, 'Иван', 'Ткачев', 'Николаевич', 1, 4, 16, NULL);
INSERT INTO `scoresheet`.`student` (`id`, `name`, `surname`, `fathername`, `group`, `course`, `user_id`, `info`) VALUES (17, 'Павел', 'Ткачук', 'Александрович', 1, 4, 17, NULL);
INSERT INTO `scoresheet`.`student` (`id`, `name`, `surname`, `fathername`, `group`, `course`, `user_id`, `info`) VALUES (18, 'Иван', 'Травничев', 'Николаевич', 1, 4, 18, NULL);
INSERT INTO `scoresheet`.`student` (`id`, `name`, `surname`, `fathername`, `group`, `course`, `user_id`, `info`) VALUES (19, 'Антон', 'Штабной', 'Викторович', 1, 4, 19, NULL);
INSERT INTO `scoresheet`.`student` (`id`, `name`, `surname`, `fathername`, `group`, `course`, `user_id`, `info`) VALUES (20, 'Максим', 'Эльяшевич', 'Юрьевич', 1, 4, 20, NULL);

COMMIT;


-- -----------------------------------------------------
-- Data for table `scoresheet`.`teacher`
-- -----------------------------------------------------
START TRANSACTION;
USE `scoresheet`;
INSERT INTO `scoresheet`.`teacher` (`id`, `name`, `surname`, `fathername`, `user_id`, `info`) VALUES (1, 'Александр', 'Исаченко', 'Николаевич', 21, 'Преподает ИСО, СУБД. Кафедра ИСУ');
INSERT INTO `scoresheet`.`teacher` (`id`, `name`, `surname`, `fathername`, `user_id`, `info`) VALUES (2, 'Владимир', 'Образцов', 'Алексеевич', 22, 'Преподает ИИС. Кафедра ИСУ');
INSERT INTO `scoresheet`.`teacher` (`id`, `name`, `surname`, `fathername`, `user_id`, `info`) VALUES (3, 'Валерий', 'Кирлица', 'Петрович', 23, 'Преподает ИИСМ. Кафедра ММАД');

COMMIT;


-- -----------------------------------------------------
-- Data for table `scoresheet`.`administration`
-- -----------------------------------------------------
START TRANSACTION;
USE `scoresheet`;
INSERT INTO `scoresheet`.`administration` (`id`, `name`, `surname`, `fathername`, `info`, `user_id`) VALUES (1, 'Татьяна', 'Воротницкая', 'Ивановна', 'Старший преподаватель кафедры теории вероятностей и математической статистики, заместитель декана по учебно-воспитательной работе ФПМИ ', 24);

COMMIT;


-- -----------------------------------------------------
-- Data for table `scoresheet`.`subject`
-- -----------------------------------------------------
START TRANSACTION;
USE `scoresheet`;
INSERT INTO `scoresheet`.`subject` (`id`, `name`) VALUES (1, 'ИИС');
INSERT INTO `scoresheet`.`subject` (`id`, `name`) VALUES (2, 'СУБД');
INSERT INTO `scoresheet`.`subject` (`id`, `name`) VALUES (3, 'ИИСМ');

COMMIT;


-- -----------------------------------------------------
-- Data for table `scoresheet`.`mark_category`
-- -----------------------------------------------------
START TRANSACTION;
USE `scoresheet`;
INSERT INTO `scoresheet`.`mark_category` (`id`, `name`) VALUES (1, 'auditory');
INSERT INTO `scoresheet`.`mark_category` (`id`, `name`) VALUES (2, 'control');
INSERT INTO `scoresheet`.`mark_category` (`id`, `name`) VALUES (3, 'skip');
INSERT INTO `scoresheet`.`mark_category` (`id`, `name`) VALUES (4, 'rating');
INSERT INTO `scoresheet`.`mark_category` (`id`, `name`) VALUES (5, 'exam');

COMMIT;


-- -----------------------------------------------------
-- Data for table `scoresheet`.`mark`
-- -----------------------------------------------------
START TRANSACTION;
USE `scoresheet`;
INSERT INTO `scoresheet`.`mark` (`id`, `student_id`, `teacher_id`, `mark`, `subject`, `category`, `mark_date`) VALUES (1, 2, 1, '8', 2, 1, '2018-11-10');
INSERT INTO `scoresheet`.`mark` (`id`, `student_id`, `teacher_id`, `mark`, `subject`, `category`, `mark_date`) VALUES (2, 6, 1, '9', 2, 1, '2018-11-10');

COMMIT;


-- -----------------------------------------------------
-- Data for table `scoresheet`.`group_subject`
-- -----------------------------------------------------
START TRANSACTION;
USE `scoresheet`;
INSERT INTO `scoresheet`.`group_subject` (`id`, `subject_id`, `teacher_id`, `group`, `course`) VALUES (1, 1, 2, 1, 4);
INSERT INTO `scoresheet`.`group_subject` (`id`, `subject_id`, `teacher_id`, `group`, `course`) VALUES (2, 2, 1, 1, 4);
INSERT INTO `scoresheet`.`group_subject` (`id`, `subject_id`, `teacher_id`, `group`, `course`) VALUES (3, 3, 3, 1, 4);

COMMIT;

